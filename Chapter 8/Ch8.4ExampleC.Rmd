---
title: Section 8.4, Example C - Method of Moments Estimation of the Parameters of
  the Gamma Distribution
output:
  pdf_document: default
  html_notebook: default
---

This is an [R Markdown](http://rmarkdown.rstudio.com) Notebook. When you execute code within the notebook, the results appear beneath the code. 

Try executing this chunk by clicking the *Run* button within the chunk or by placing your cursor inside it and pressing *Ctrl+Shift+Enter*. 

First we load the data.

```{r}
getwd()
```

```{r, echo = FALSE}
data <- scan("../Excel Comma/Chapter 10/Illinois60.csv")
data <- c(data, scan("../Excel Comma/Chapter 10/Illinois61.csv"))
data <- c(data, scan("../Excel Comma/Chapter 10/Illinois62.csv"))
data <- c(data, scan("../Excel Comma/Chapter 10/Illinois63.csv"))
data <- c(data, scan("../Excel Comma/Chapter 10/Illinois64.csv"))

          
```

```{r}
length(data)
```
The data has been loaded correctly.

We will model the data with a gamma distribution with parameters $\alpha$ and $\beta$. From the text, the method of moments estimates of the parameters are

$$
\hat{\alpha} = \frac{\bar{X}^2}{\hat{\sigma}^2}
$$

and

$$
\hat{\beta} = \frac{\bar{X}}{\hat{\sigma}^2}
$$

Now we calculate $\bar{X}$ and $\bar{\sigma}^2$.

```{r}
xbar = mean(data)
sigma2hat = var(data)
bhat = xbar / sigma2hat
ahat = bhat * xbar
```

The data has $\bar{X} =$ `r xbar` and $\hat{\sigma}^2 =$ `r sigma2hat`. This produces estimates of $\hat{\alpha} =$ `r ahat` and $\hat{\beta} =$ `r bhat`.

Now we will calculate the standard errors for these estimates. We will generate 1000 samples of 227 draws from a gamma distribution with $\hat{\alpha} =$ `r ahat` and $\hat{\beta} =$ `r bhat`, then calculate 1000 isntances of $\hat{\alpha}$ and $\hat{\beta}$, then take the standard deviations of those estimates and use them as estimates for the standard deviation of $\hat{\alpha}$ and $\hat{\beta}$.

```{r}
# Initialize the vectors
ahat_est <- vector(mode = 'numeric', length = 1000)
bhat_est <- vector(mode = 'numeric', length = 1000)

gen_ahat <- function(data) {
  xbar <- mean(data)
  sigma2hat <- var(data)
  ahat <- xbar^2 / sigma2hat
  return(ahat)
}

gen_bhat <- function(data) {
  xbar <- mean(data)
  sigma2hat <- var(data)
  bhat <- xbar / sigma2hat
  return(bhat)
}

#Generate 1000 draws from a gamma distribution and calculate the resulting a hat and b hat
set.seed(1000)
for(i in 1:1000){
  data <- rgamma(227, shape = ahat, rate = bhat)
  ahat_est[i] <- gen_ahat(data)
  bhat_est[i] <- gen_bhat(data)
}

ahat_ste <- sd(ahat_est)
bhat_ste <- sd(bhat_est)

```

Thus the estimates of the standard errors for $\hat{\alpha}$ and $\hat{\beta}$ are $s_{\hat{
\alpha}} =$ `r ahat_ste` and $s_{\hat{
\beta}} =$ `r bhat_ste`. The corresponding estimates in the book are 0.06 and 0.34, respectively.